(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{970:function(e,t,r){Promise.resolve().then(r.bind(r,3661))},3661:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r(7437);class u{addTexture(){let e=this.device.createTexture({size:[4096,4096],format:"rgba8unorm",dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),t=this.device.createCommandEncoder();return this.device.queue.submit([t.finish()]),this.textures.push(e),e}getMemoryUsage(){return this.textures.reduce((e,t)=>e+t.width*t.height*4,0)}static async fromNavigator(){let e=await navigator.gpu.requestAdapter();if(!e)throw Error("WebGPU not supported");return new u(await e.requestDevice())}constructor(e){this.device=e,this.textures=[],e.lost.then(e=>{console.error("GPU Device lost",e)}),e.onuncapturederror=e=>{console.error("GPU Uncaptured error",e)}}}var s=r(2265);function i(){let e=function(){let[e,t]=(0,s.useState)();return(0,s.useEffect)(()=>{u.fromNavigator().then(e=>t(e))},[t]),e}(),t=function(){let e=(0,s.useRef)();function t(){clearTimeout(e.current),clearInterval(e.current),e.current=void 0}return{timeoutRef:e,startInterval:function(r,n){t(),e.current=setInterval(r,n)},startTimeout:function(r,n){t(),e.current=setTimeout(()=>{r(),t()},n)},clear:t}}(),[r,i]=(0,s.useState)(!1),c=(0,s.useCallback)(()=>{null==e||e.addTexture(),i(e=>!e)},[e,i]),o=(0,s.useCallback)(()=>{t.startInterval(c,100),i(e=>!e)},[t,i]),a=(0,s.useCallback)(()=>{t.clear(),i(e=>!e)},[t,i]);return(0,n.jsxs)("main",{style:{textAlign:"center",margin:"2em"},children:[(0,n.jsx)("h1",{children:"GPU Test"}),e?(0,n.jsxs)(n.Fragment,{children:[t.timeoutRef.current?(0,n.jsx)("p",{children:(0,n.jsx)("button",{onClick:a,children:"Stop Auto"})}):(0,n.jsxs)("p",{children:[(0,n.jsx)("button",{onClick:o,children:"Start Auto"}),(0,n.jsx)("br",{}),(0,n.jsx)("button",{onClick:c,children:"Add Texture"})]}),(0,n.jsxs)("p",{children:["Allocated memory: ",function(e){let t=e,r=["Bytes","KB","MB","GB","TB"],n=[0,0,1,2,3];for(;t>1024;)t/=1024,r.shift(),n.shift();return"".concat(t.toFixed(n[0])," ").concat(r[0])}(e.getMemoryUsage())]})]}):(0,n.jsx)("div",{children:"loading..."})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=970)}),_N_E=e.O()}]);